<!-- templates/home.html -->
{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container">
    <!-- Hero Section -->
    <div class="row min-vh-100 align-items-center">
        <div class="col-lg-6">
            <div class="mb-4">
                <span class="badge privacy-badge mb-3">üîí PRIVACY-FIRST AI</span>
                <h1 class="display-3 fw-bold glow-text mb-4">
                    Your AI.<br>
                    Your Data.<br>
                    Your Control.
                </h1>
                <p class="lead text-secondary mb-4">
                    CypherVault is a privacy-first AI assistant that runs entirely on your DAWN Black Box. 
                    No cloud. No tracking. No compromises.
                </p>
            </div>
            
            <div class="d-flex gap-3 mb-5">
                {% if user.is_authenticated %}
                    <a href="{% url 'dashboard' %}" class="btn btn-cyber btn-lg">
                        Open Dashboard ‚Üí
                    </a>
                {% else %}
                    <a href="{% url 'register' %}" class="btn btn-cyber btn-lg">
                        Get Started ‚Üí
                    </a>
                    <a href="{% url 'login' %}" class="btn btn-outline-light btn-lg">
                        Sign In
                    </a>
                {% endif %}
            </div>
            
            <!-- Trust Indicators -->
            <div class="row g-3">
                <div class="col-4">
                    <div class="cyber-card p-3 text-center">
                        <div class="h3 mb-0 glow-text">{{ stats.total_conversations|default:0 }}+</div>
                        <small class="text-secondary">Conversations</small>
                    </div>
                </div>
                <div class="col-4">
                    <div class="cyber-card p-3 text-center">
                        <div class="h3 mb-0 glow-text">{{ stats.messages_encrypted|default:0 }}+</div>
                        <small class="text-secondary">Messages Encrypted</small>
                    </div>
                </div>
                <div class="col-4">
                    <div class="cyber-card p-3 text-center">
                        <div class="h3 mb-0 glow-text">100%</div>
                        <small class="text-secondary">Private</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-6">
            <!-- Interactive Demo Card -->
            <div class="cyber-card p-4 position-relative">
                <div class="position-absolute top-0 end-0 m-3">
                    <span class="privacy-badge">üü¢ LIVE DEMO</span>
                </div>
                
                <h5 class="mb-4">Try CypherVault</h5>
                
                <div id="demo-chat" class="mb-3" style="height: 300px; overflow-y: auto;">
                    <div class="message-wrapper mb-3">
                        <div class="d-flex">
                            <div class="message-bubble p-3 rounded-3" style="max-width: 80%; background: var(--secondary);">
                                <div class="mb-2">
                                    <span class="badge" style="background: rgba(0,0,0,0.2); font-size: 10px;">ü§ñ AI</span>
                                </div>
                                Hello! I'm CypherVault, your private AI assistant. Ask me anything - all conversations stay on your device.
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="input-group">
                    <input type="text" id="demo-input" class="form-control bg-dark text-white border-secondary" 
                           placeholder="Try: 'What makes you different?'">
                    <button class="btn btn-cyber" onclick="sendDemoMessage()">Send</button>
                </div>
                
                <div class="text-center mt-3">
                    <small class="text-secondary">
                        <i class="bi bi-shield-check"></i> This demo runs locally in your browser
                    </small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Features Section -->
    <div class="row py-5">
        <div class="col-12 text-center mb-5">
            <h2 class="display-5 fw-bold glow-text">Why CypherVault?</h2>
            <p class="lead text-secondary">Built for privacy, powered by your Black Box</p>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="cyber-card p-4 h-100 text-center">
                <div class="mb-3" style="font-size: 48px;">üîí</div>
                <h4 class="mb-3">End-to-End Encryption</h4>
                <p class="text-secondary">
                    Every message is encrypted before storage. Not even the server can read your conversations.
                </p>
            </div>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="cyber-card p-4 h-100 text-center">
                <div class="mb-3" style="font-size: 48px;">üíª</div>
                <h4 class="mb-3">100% Local Processing</h4>
                <p class="text-secondary">
                    AI runs on your Black Box using Ollama. No cloud APIs, no external servers, no data leaks.
                </p>
            </div>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="cyber-card p-4 h-100 text-center">
                <div class="mb-3" style="font-size: 48px;">‚ö°</div>
                <h4 class="mb-3">Lightning Fast</h4>
                <p class="text-secondary">
                    No network latency. Your AI responds instantly because it runs right on your hardware.
                </p>
            </div>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="cyber-card p-4 h-100 text-center">
                <div class="mb-3" style="font-size: 48px;">üõ°Ô∏è</div>
                <h4 class="mb-3">Zero Data Collection</h4>
                <p class="text-secondary">
                    We don't collect, store, or analyze your data. Ever. Your privacy is non-negotiable.
                </p>
            </div>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="cyber-card p-4 h-100 text-center">
                <div class="mb-3" style="font-size: 48px;">üåê</div>
                <h4 class="mb-3">DePIN Ready</h4>
                <p class="text-secondary">
                    Built for DAWN's Black Box. Earn rewards while maintaining complete data sovereignty.
                </p>
            </div>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="cyber-card p-4 h-100 text-center">
                <div class="mb-3" style="font-size: 48px;">üîß</div>
                <h4 class="mb-3">Open Source</h4>
                <p class="text-secondary">
                    Fully auditable code. No black boxes (except the Black Box itself). Trust through transparency.
                </p>
            </div>
        </div>
    </div>
    
    <!-- Technical Stack Section -->
    <div class="row py-5">
        <div class="col-12 text-center mb-5">
            <h2 class="display-5 fw-bold glow-text">Powered By</h2>
            <p class="lead text-secondary">Modern privacy tech stack</p>
        </div>
        
        <div class="col-lg-8 offset-lg-2">
            <div class="cyber-card p-4">
                <div class="row g-3 text-center">
                    <div class="col-6 col-md-3">
                        <div class="p-3">
                            <div class="fw-bold mb-1">Ollama</div>
                            <small class="text-secondary">Local LLM</small>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="p-3">
                            <div class="fw-bold mb-1">Django</div>
                            <small class="text-secondary">Backend</small>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="p-3">
                            <div class="fw-bold mb-1">Fernet</div>
                            <small class="text-secondary">Encryption</small>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="p-3">
                            <div class="fw-bold mb-1">Docker</div>
                            <small class="text-secondary">Container</small>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <span class="badge privacy-badge">
                        {% if llm_available %}
                            üü¢ LLM Online
                        {% else %}
                            üü° Mock Mode (Install Ollama for full features)
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- CTA Section -->
    <div class="row py-5 my-5">
        <div class="col-lg-8 offset-lg-2 text-center">
            <div class="cyber-card p-5">
                <h2 class="display-5 fw-bold glow-text mb-4">Ready to take control?</h2>
                <p class="lead text-secondary mb-4">
                    Join the privacy revolution. Your AI assistant that truly respects your data.
                </p>
                {% if not user.is_authenticated %}
                <a href="{% url 'register' %}" class="btn btn-cyber btn-lg">
                    Start Using CypherVault ‚Üí
                </a>
                {% else %}
                <a href="{% url 'dashboard' %}" class="btn btn-cyber btn-lg">
                    Go to Dashboard ‚Üí
                </a>
                {% endif %}
                <div class="mt-4">
                    <small class="text-secondary">
                        üê≥ Runs in Docker ‚Ä¢ üîí End-to-End Encrypted ‚Ä¢ ‚ö° No Setup Required
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.message-bubble {
    animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>

<script>
function sendDemoMessage() {
    const input = document.getElementById('demo-input');
    const message = input.value.trim();
    if (!message) return;
    
    const chatDiv = document.getElementById('demo-chat');
    
    // Add user message
    chatDiv.innerHTML += `
        <div class="message-wrapper mb-3">
            <div class="d-flex justify-content-end">
                <div class="message-bubble p-3 rounded-3" style="max-width: 80%; background: linear-gradient(135deg, var(--primary-accent) 0%, #00b8d4 100%); color: #000;">
                    <div class="mb-2">
                        <span class="badge" style="background: rgba(0,0,0,0.2); font-size: 10px;">üë§ You</span>
                    </div>
                    ${escapeHtml(message)}
                </div>
            </div>
        </div>
    `;
    
    input.value = '';
    chatDiv.scrollTop = chatDiv.scrollHeight;
    
    // Simulate AI response
    setTimeout(() => {
        const responses = {
            'different': "Unlike ChatGPT or Claude, I run entirely on YOUR hardware. Your conversations never leave your device, and you maintain complete control over your data. No subscriptions, no data mining, no privacy concerns.",
            'privacy': "Privacy is my core principle. Every message is encrypted end-to-end, processed locally on your Black Box, and never sent to external servers. You own your data, not me.",
            'work': "I use Ollama to run open-source language models directly on your Black Box. All processing happens locally - no internet required for inference. Your data stays in your home.",
            'safe': "Absolutely! With end-to-end encryption, local processing, and open-source code, you can verify exactly how your data is handled. No black boxes, just privacy.",
            'default': "I'm a privacy-first AI assistant running on your DAWN Black Box. I can help with questions, writing, coding, and more - all while keeping your data completely private and local!"
        };
        
        let response = responses['default'];
        const lowerMsg = message.toLowerCase();
        
        for (let key in responses) {
            if (lowerMsg.includes(key)) {
                response = responses[key];
                break;
            }
        }
        
        chatDiv.innerHTML += `
            <div class="message-wrapper mb-3">
                <div class="d-flex">
                    <div class="message-bubble p-3 rounded-3" style="max-width: 80%; background: var(--secondary);">
                        <div class="mb-2">
                            <span class="badge" style="background: rgba(0,0,0,0.2); font-size: 10px;">ü§ñ AI</span>
                        </div>
                        ${response}
                    </div>
                </div>
            </div>
        `;
        
        chatDiv.scrollTop = chatDiv.scrollHeight;
    }, 800);
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Enter key support
document.getElementById('demo-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendDemoMessage();
});
</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
{% endblock %}